{"version":3,"sources":["astro.js","throttle.js","chilloclock.js"],"names":["calcTimeJulianCent","jd","T","calcJDFromJulianCent","t","JD","isLeapYear","yr","calcDateFromJD","z","Math","floor","f","A","alpha","B","C","D","E","month","year","day","calcDoyFromJD","date","k","doy","radToDeg","angleRad","PI","degToRad","angleDeg","calcGeomMeanLongSun","L0","calcGeomMeanAnomalySun","M","calcEccentricityEarthOrbit","e","calcSunEqOfCenter","m","mrad","sin","calcSunTrueLong","O","calcSunTrueAnomaly","v","calcSunRadVector","R","cos","calcSunApparentLong","o","omega","lambda","calcMeanObliquityOfEcliptic","e0","calcObliquityCorrection","calcSunRtAscension","tananum","tanadenom","atan2","calcSunDeclination","sint","theta","asin","calcEquationOfTime","epsilon","l0","y","tan","sin2l0","sinm","calcHourAngleSunrise","lat","solarDec","latRad","sdRad","HAarg","HA","acos","isNumber","inputVal","oneDecimal","inputStr","i","length","oneChar","charAt","getJD","calcRefraction","elev","correction","te","calcAzEl","localtime","latitude","longitude","zone","trueSolarTime","eqTime","solarTimeFix","hourAngle","haRad","csz","zenith","azDenom","abs","azRad","azimuth","elevation","calcSolNoon","timezone","solNoonLocal","tnoon","calcSunriseSetUTC","rise","timeUTC","calcSunriseSet","Error","newTimeUTC","timeLocal","jday","increment","calcJDofNextPrevRiseSet","next","tz","julianday","time","incr","DEFAULT_DELAY","throttle","callback","delay","callbackArgs","ready","wasInvoked","readyCallback","apply","undefined","setTimeout","args","HELP_FADE_DELAY","MINUTES_PER_DAY","TWELVE_HOURS_IN_MS","config","Proxy","JSON","parse","localStorage","getItem","get","target","property","set","value","requestAnimationFrame","setItem","stringify","helpIconNode","document","getElementById","welcomeNode","closeIcon","querySelector","clockNode","fadeOverlayNode","baseSize","style","setProperty","sunrise","sunset","timePeriodBegin","timePeriodDuration","isNight","updateHandle","updateFrequency","update","clearTimeout","now","Date","timeInMinutes","getHours","getMinutes","isAfterMidnight","percentOfTimePeriodElapsed","initClock","geolocation","timelocal","classList","contains","add","armAngle","addEventListener","event","remove","hidden","helpFadeHandle","fadeoutHelp","showHelpIcon","hideWelcome","onKeydown","key","timezoneOffset","getTimezoneOffset","getFullYear","getMonth","getDate","previousDay","getTime","previousJday","previousSunset","nextDay","nextJday","body","hasGeolocation","navigator","showLocationForm","cityInput","window","open","coordinatesForm","preventDefault","elements","Number","showWelcomeDialog","locationButton","getCurrentPosition","position","coords","animationName","parseInt","getComputedStyle","getPropertyValue"],"mappings":"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","file":"chilloclock.a47bae29.js","sourceRoot":"..","sourcesContent":["/* from https://www.esrl.noaa.gov/gmd/grad/solcalc/main.js */\n\nfunction calcTimeJulianCent(jd) {\n\tvar T = (jd - 2451545.0)/36525.0\n\treturn T\n}\n\nfunction calcJDFromJulianCent(t) {\n\tvar JD = t * 36525.0 + 2451545.0\n\treturn JD\n}\n\nfunction isLeapYear(yr) {\n\treturn ((yr % 4 == 0 && yr % 100 != 0) || yr % 400 == 0);\n}\n\nfunction calcDateFromJD(jd) {\n\tvar z = Math.floor(jd + 0.5);\n\tvar f = (jd + 0.5) - z;\n\tif (z < 2299161) {\n\t\tvar A = z;\n\t} else {\n\t\tvar alpha = Math.floor((z - 1867216.25)/36524.25);\n\t\tvar A = z + 1 + alpha - Math.floor(alpha/4);\n\t}\n\tvar B = A + 1524;\n\tvar C = Math.floor((B - 122.1)/365.25);\n\tvar D = Math.floor(365.25 * C);\n\tvar E = Math.floor((B - D)/30.6001);\n\tvar day = B - D - Math.floor(30.6001 * E) + f;\n\tvar month = (E < 14) ? E - 1 : E - 13;\n\tvar year = (month > 2) ? C - 4716 : C - 4715;\n\n\treturn {\"year\": year, \"month\": month, \"day\": day}\n}\n\nfunction calcDoyFromJD(jd) {\n\tvar date = calcDateFromJD(jd)\n\n\tvar k = (isLeapYear(date.year) ? 1 : 2);\n\tvar doy = Math.floor((275 * date.month)/9) - k * Math.floor((date.month + 9)/12) + date.day -30;\n\n\treturn doy;\n}\n\n\nfunction radToDeg(angleRad) {\n\treturn (180.0 * angleRad / Math.PI);\n}\n\nfunction degToRad(angleDeg) {\n\treturn (Math.PI * angleDeg / 180.0);\n}\n\nfunction calcGeomMeanLongSun(t) {\n\tvar L0 = 280.46646 + t * (36000.76983 + t*(0.0003032))\n\twhile(L0 > 360.0) {\n\t\tL0 -= 360.0\n\t}\n\twhile(L0 < 0.0) {\n\t\tL0 += 360.0\n\t}\n\treturn L0\t\t// in degrees\n}\n\nfunction calcGeomMeanAnomalySun(t) {\n\tvar M = 357.52911 + t * (35999.05029 - 0.0001537 * t);\n\treturn M;\t\t// in degrees\n}\n\nfunction calcEccentricityEarthOrbit(t) {\n\tvar e = 0.016708634 - t * (0.000042037 + 0.0000001267 * t);\n\treturn e;\t\t// unitless\n}\n\nfunction calcSunEqOfCenter(t) {\n\tvar m = calcGeomMeanAnomalySun(t);\n\tvar mrad = degToRad(m);\n\tvar sinm = Math.sin(mrad);\n\tvar sin2m = Math.sin(mrad+mrad);\n\tvar sin3m = Math.sin(mrad+mrad+mrad);\n\tvar C = sinm * (1.914602 - t * (0.004817 + 0.000014 * t)) + sin2m * (0.019993 - 0.000101 * t) + sin3m * 0.000289;\n\treturn C;\t\t// in degrees\n}\n\nfunction calcSunTrueLong(t) {\n\tvar l0 = calcGeomMeanLongSun(t);\n\tvar c = calcSunEqOfCenter(t);\n\tvar O = l0 + c;\n\treturn O;\t\t// in degrees\n}\n\nfunction calcSunTrueAnomaly(t) {\n\tvar m = calcGeomMeanAnomalySun(t);\n\tvar c = calcSunEqOfCenter(t);\n\tvar v = m + c;\n\treturn v;\t\t// in degrees\n}\n\nfunction calcSunRadVector(t) {\n\tvar v = calcSunTrueAnomaly(t);\n\tvar e = calcEccentricityEarthOrbit(t);\n\tvar R = (1.000001018 * (1 - e * e)) / (1 + e * Math.cos(degToRad(v)));\n\treturn R;\t\t// in AUs\n}\n\nfunction calcSunApparentLong(t) {\n\tvar o = calcSunTrueLong(t);\n\tvar omega = 125.04 - 1934.136 * t;\n\tvar lambda = o - 0.00569 - 0.00478 * Math.sin(degToRad(omega));\n\treturn lambda;\t\t// in degrees\n}\n\nfunction calcMeanObliquityOfEcliptic(t) {\n\tvar seconds = 21.448 - t*(46.8150 + t*(0.00059 - t*(0.001813)));\n\tvar e0 = 23.0 + (26.0 + (seconds/60.0))/60.0;\n\treturn e0;\t\t// in degrees\n}\n\nfunction calcObliquityCorrection(t) {\n\tvar e0 = calcMeanObliquityOfEcliptic(t);\n\tvar omega = 125.04 - 1934.136 * t;\n\tvar e = e0 + 0.00256 * Math.cos(degToRad(omega));\n\treturn e;\t\t// in degrees\n}\n\nfunction calcSunRtAscension(t) {\n\tvar e = calcObliquityCorrection(t);\n\tvar lambda = calcSunApparentLong(t);\n\tvar tananum = (Math.cos(degToRad(e)) * Math.sin(degToRad(lambda)));\n\tvar tanadenom = (Math.cos(degToRad(lambda)));\n\tvar alpha = radToDeg(Math.atan2(tananum, tanadenom));\n\treturn alpha;\t\t// in degrees\n}\n\nfunction calcSunDeclination(t) {\n\tvar e = calcObliquityCorrection(t);\n\tvar lambda = calcSunApparentLong(t);\n\tvar sint = Math.sin(degToRad(e)) * Math.sin(degToRad(lambda));\n\tvar theta = radToDeg(Math.asin(sint));\n\treturn theta;\t\t// in degrees\n}\n\nfunction calcEquationOfTime(t) {\n\tvar epsilon = calcObliquityCorrection(t);\n\tvar l0 = calcGeomMeanLongSun(t);\n\tvar e = calcEccentricityEarthOrbit(t);\n\tvar m = calcGeomMeanAnomalySun(t);\n\n\tvar y = Math.tan(degToRad(epsilon)/2.0);\n\ty *= y;\n\n\tvar sin2l0 = Math.sin(2.0 * degToRad(l0));\n\tvar sinm   = Math.sin(degToRad(m));\n\tvar cos2l0 = Math.cos(2.0 * degToRad(l0));\n\tvar sin4l0 = Math.sin(4.0 * degToRad(l0));\n\tvar sin2m  = Math.sin(2.0 * degToRad(m));\n\n\tvar Etime = y * sin2l0 - 2.0 * e * sinm + 4.0 * e * y * sinm * cos2l0 - 0.5 * y * y * sin4l0 - 1.25 * e * e * sin2m;\n\treturn radToDeg(Etime)*4.0;\t// in minutes of time\n}\n\nfunction calcHourAngleSunrise(lat, solarDec) {\n\tvar latRad = degToRad(lat);\n\tvar sdRad  = degToRad(solarDec);\n\tvar HAarg = (Math.cos(degToRad(90.833))/(Math.cos(latRad)*Math.cos(sdRad))-Math.tan(latRad) * Math.tan(sdRad));\n\tvar HA = Math.acos(HAarg);\n\treturn HA;\t\t// in radians (for sunset, use -HA)\n}\n\nfunction isNumber(inputVal) {\n\tvar oneDecimal = false;\n\tvar inputStr = \"\" + inputVal;\n\tfor (var i = 0; i < inputStr.length; i++) {\n\t\tvar oneChar = inputStr.charAt(i);\n\t\tif (i == 0 && (oneChar == \"-\" || oneChar == \"+\")) {\n\t\t\tcontinue;\n\t\t}\n\t\tif (oneChar == \".\" && !oneDecimal) {\n\t\t\toneDecimal = true;\n\t\t\tcontinue;\n\t\t}\n\t\tif (oneChar < \"0\" || oneChar > \"9\") {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nexport function getJD(year, month, day) {\n\tif (month <= 2) {\n\t\tyear -= 1\n\t\tmonth += 12\n\t}\n\tvar A = Math.floor(year/100)\n\tvar B = 2 - A + Math.floor(A/4)\n\tvar JD = Math.floor(365.25*(year + 4716)) + Math.floor(30.6001*(month+1)) + day + B - 1524.5\n\treturn JD\n}\n\nfunction calcRefraction(elev) {\n\n\tif (elev > 85.0) {\n\t\tvar correction = 0.0;\n\t} else {\n\t\tvar te = Math.tan(degToRad(elev));\n\t\tif (elev > 5.0) {\n\t\t\tvar correction = 58.1 / te - 0.07 / (te*te*te) + 0.000086 / (te*te*te*te*te);\n\t\t} else if (elev > -0.575) {\n\t\t\tvar correction = 1735.0 + elev * (-518.2 + elev * (103.4 + elev * (-12.79 + elev * 0.711) ) );\n\t\t} else {\n\t\t\tvar correction = -20.774 / te;\n\t\t}\n\t\tcorrection = correction / 3600.0;\n\t}\n\n\treturn correction\n}\n\nfunction calcAzEl(T, localtime, latitude, longitude, zone) {\n\n\tvar eqTime = calcEquationOfTime(T)\n\tvar theta  = calcSunDeclination(T)\n\n\tvar solarTimeFix = eqTime + 4.0 * longitude - 60.0 * zone\n\tvar earthRadVec = calcSunRadVector(T)\n\tvar trueSolarTime = localtime + solarTimeFix\n\twhile (trueSolarTime > 1440) {\n\t\ttrueSolarTime -= 1440\n\t}\n\tvar hourAngle = trueSolarTime / 4.0 - 180.0;\n\tif (hourAngle < -180) {\n\t\thourAngle += 360.0\n\t}\n\tvar haRad = degToRad(hourAngle)\n\tvar csz = Math.sin(degToRad(latitude)) * Math.sin(degToRad(theta)) + Math.cos(degToRad(latitude)) * Math.cos(degToRad(theta)) * Math.cos(haRad)\n\tif (csz > 1.0) {\n\t\tcsz = 1.0\n\t} else if (csz < -1.0) {\n\t\tcsz = -1.0\n\t}\n\tvar zenith = radToDeg(Math.acos(csz))\n\tvar azDenom = ( Math.cos(degToRad(latitude)) * Math.sin(degToRad(zenith)) )\n\tif (Math.abs(azDenom) > 0.001) {\n\t\tvar azRad = (( Math.sin(degToRad(latitude)) * Math.cos(degToRad(zenith)) ) - Math.sin(degToRad(theta))) / azDenom\n\t\tif (Math.abs(azRad) > 1.0) {\n\t\t\tif (azRad < 0) {\n\t\t\t\tazRad = -1.0\n\t\t\t} else {\n\t\t\t\tazRad = 1.0\n\t\t\t}\n\t\t}\n\t\tvar azimuth = 180.0 - radToDeg(Math.acos(azRad))\n\t\tif (hourAngle > 0.0) {\n\t\t\tazimuth = -azimuth\n\t\t}\n\t} else {\n\t\tif (latitude > 0.0) {\n\t\t\tvar azimuth = 180.0\n\t\t} else {\n\t\t\tvar azimuth = 0.0\n\t\t}\n\t}\n\tif (azimuth < 0.0) {\n\t\tazimuth += 360.0\n\t}\n\tvar exoatmElevation = 90.0 - zenith\n\n\t// Atmospheric Refraction correction\n\tvar refractionCorrection = calcRefraction(exoatmElevation)\n\n\tvar solarZen = zenith - refractionCorrection;\n\tvar elevation = 90.0 - solarZen\n\n\treturn {\"azimuth\": azimuth, \"elevation\": elevation}\n}\n\nfunction calcSolNoon(jd, longitude, timezone) {\n\tvar tnoon = calcTimeJulianCent(jd - longitude/360.0)\n\tvar eqTime = calcEquationOfTime(tnoon)\n\tvar solNoonOffset = 720.0 - (longitude * 4) - eqTime // in minutes\n\tvar newt = calcTimeJulianCent(jd + solNoonOffset/1440.0)\n\teqTime = calcEquationOfTime(newt)\n\tvar solNoonLocal = 720 - (longitude * 4) - eqTime + (timezone*60.0)// in minutes\n\twhile (solNoonLocal < 0.0) {\n\t\tsolNoonLocal += 1440.0;\n\t}\n\twhile (solNoonLocal >= 1440.0) {\n\t\tsolNoonLocal -= 1440.0;\n\t}\n\n\treturn solNoonLocal\n}\n\n\n\nfunction calcSunriseSetUTC(rise, JD, latitude, longitude) {\n\tvar t = calcTimeJulianCent(JD);\n\tvar eqTime = calcEquationOfTime(t);\n\tvar solarDec = calcSunDeclination(t);\n\tvar hourAngle = calcHourAngleSunrise(latitude, solarDec);\n\tif (!rise) hourAngle = -hourAngle;\n\tvar delta = longitude + radToDeg(hourAngle);\n\tvar timeUTC = 720 - (4.0 * delta) - eqTime;\t// in minutes\n\n\treturn timeUTC\n}\n\n// rise = 1 for sunrise, 0 for sunset\nexport function calcSunriseSet(rise, JD, latitude, longitude, timezone) {\n\tif (typeof latitude !== 'number') {\n\t\tthrow new Error('latitude must be a number');\n\t}\n\tif (typeof longitude !== 'number') {\n\t\tthrow new Error('longitude must be a number');\n\t}\n\n\tvar timeUTC = calcSunriseSetUTC(rise, JD, latitude, longitude);\n\tvar newTimeUTC = calcSunriseSetUTC(rise, JD + timeUTC/1440.0, latitude, longitude);\n\tif (isNumber(newTimeUTC)) {\n\t\tvar timeLocal = newTimeUTC + (timezone * 60.0)\n\t\tvar riseT = calcTimeJulianCent(JD + newTimeUTC/1440.0)\n\t\tvar riseAzEl = calcAzEl(riseT, timeLocal, latitude, longitude, timezone)\n\t\tvar azimuth = riseAzEl.azimuth\n\t\tvar jday = JD\n\t\tif ( (timeLocal < 0.0) || (timeLocal >= 1440.0) ) {\n\t\t\tvar increment = ((timeLocal < 0) ? 1 : -1)\n\t\t\twhile ((timeLocal < 0.0)||(timeLocal >= 1440.0)) {\n\t\t\t\ttimeLocal += increment * 1440.0\n\t\t\t\tjday -= increment\n\t\t\t}\n\t\t}\n\n\t} else { // no sunrise/set found\n\n\t\tvar azimuth = -1.0\n\t\tvar timeLocal = 0.0\n\t\tvar doy = calcDoyFromJD(JD)\n\t\tif ( ((latitude > 66.4) && (doy > 79) && (doy < 267)) ||\n\t\t     ((latitude < -66.4) && ((doy < 83) || (doy > 263))) ) {\n\t\t\t//previous sunrise/next sunset\n\t\t\tjday = calcJDofNextPrevRiseSet(!rise, rise, JD, latitude, longitude, timezone)\n\t\t} else {   //previous sunset/next sunrise\n\t\t\tjday = calcJDofNextPrevRiseSet(rise, rise, JD, latitude, longitude, timezone)\n\t\t}\n\t}\n\n\treturn {\"jday\": jday, \"timelocal\": timeLocal, \"azimuth\": azimuth}\n}\n\nfunction calcJDofNextPrevRiseSet(next, rise, JD, latitude, longitude, tz) {\n\n\tvar julianday = JD;\n\tvar increment = ((next) ? 1.0 : -1.0);\n\tvar time = calcSunriseSetUTC(rise, julianday, latitude, longitude);\n\n\twhile(!isNumber(time)) {\n\t\tjulianday += increment;\n\t\ttime = calcSunriseSetUTC(rise, julianday, latitude, longitude);\n\t}\n\tvar timeLocal = time + tz * 60.0\n\twhile ((timeLocal < 0.0) || (timeLocal >= 1440.0)) {\n\t\tvar incr = ((timeLocal < 0) ? 1 : -1)\n\t\ttimeLocal += (incr * 1440.0)\n\t\tjulianday -= incr\n\t}\n\n\treturn julianday;\n}\n","const DEFAULT_DELAY = 16;\nexport function throttle(callback, delay = DEFAULT_DELAY) {\n\tlet ready = true;\n\tlet callbackArgs;\n\tlet wasInvoked = false;\n\tfunction readyCallback() {\n\t\tif (wasInvoked) {\n\t\t\tcallback.apply(this, callbackArgs);\n\t\t\tcallbackArgs = undefined;\n\t\t\twasInvoked = false;\n\t\t\tsetTimeout(readyCallback, delay);\n\t\t}\n\t\telse {\n\t\t\tready = true;\n\t\t}\n\t}\n\treturn function (...args) {\n\t\tif (ready) {\n\t\t\tready = false;\n\t\t\tsetTimeout(readyCallback, delay);\n\t\t\tcallback.apply(this, args);\n\t\t}\n\t\telse {\n\t\t\tcallbackArgs = args;\n\t\t\twasInvoked = true;\n\t\t}\n\t};\n}\n","import { calcSunriseSet, getJD } from './astro.js';\nimport { throttle } from './throttle.js';\n\nconst HELP_FADE_DELAY = 3000;\nconst MINUTES_PER_DAY = 24 * 60;\nconst TWELVE_HOURS_IN_MS = 12 * 60 * 60 * 1000;\n\nconst config = new Proxy(JSON.parse(localStorage.getItem('chilloclock') || '{}'), {\n\tget (target, property) {\n\t\treturn target[property];\n\t},\n\tset (target, property, value) {\n\t\ttarget[property] = value;\n\t\trequestAnimationFrame(function () {\n\t\t\tlocalStorage.setItem('chilloclock', JSON.stringify(target));\n\t\t});\n\n\t\treturn true;\n\t},\n});\n\nconst helpIconNode = document.getElementById('helpIcon');\nconst welcomeNode = document.getElementById('welcome');\nconst closeIcon = welcomeNode.querySelector('.closeIcon');\nconst clockNode = document.querySelector('.chilloclock');\nconst fadeOverlayNode = document.querySelector('.fadeOverlay');\n\nif (config.baseSize) {\n\tclockNode.style.setProperty('--base-size', `${config.baseSize}px`);\n}\n\nlet isNight = false;\nlet sunrise;\nlet sunset;\nlet updateHandle = 0;\n\n// during the day this will be sunrise.timelocal\n// during the night sunset.timelocal\nlet timePeriodBegin;\n\n// during the day this will be sunset.timelocal - sunrise.timelocal\n// during the night this will be nextDaySunrise.timelocal - sunset.timelocal\nlet timePeriodDuration;\n\n// 10 seconds - the angle only actually changes about once every minute\nconst updateFrequency = 10 * 1000;\n\nfunction update () {\n\tclearTimeout(updateHandle);\n\tconst now = new Date();\n\tconst timeInMinutes = (now.getHours() * 60) + now.getMinutes();\n\tconst isAfterMidnight = timeInMinutes < timePeriodBegin;\n\tconst percentOfTimePeriodElapsed = isAfterMidnight ?\n\t\t((timePeriodDuration - timeInMinutes) / timePeriodDuration) :\n\t\t((timeInMinutes - timePeriodBegin) / timePeriodDuration);\n\n\tif (percentOfTimePeriodElapsed > 1) {\n\t\tinitClock(config.geolocation.latitude, config.geolocation.longitude);\n\t\treturn;\n\t}\n\n\t// narrow interpretation of twilight as 10 minutes preceding sunset/sunrise\n\tconst isTwilight = isAfterMidnight ?\n\t\t(sunrise.timelocal - timeInMinutes) < 10 :\n\t\t(sunset.timelocal - timeInMinutes) < 10;\n\n\tif (isTwilight) {\n\t\tif (isAfterMidnight) {\n\t\t\tif (!fadeOverlayNode.classList.contains('morningFade')) {\n\t\t\t\tfadeOverlayNode.classList.add('morningFade');\n\t\t\t}\n\t\t\telse if(!fadeOverlayNode.classList.contains('nightFade')) {\n\t\t\t\tfadeOverlayNode.classList.add('nightFade');\n\t\t\t}\n\t\t}\n\t}\n\n\tconst armAngle = (180 * percentOfTimePeriodElapsed) + (isNight ? 180 : 0);\n\tclockNode.style.setProperty('--arm-angle', `${armAngle}deg`);\n\tupdateHandle = setTimeout(update, updateFrequency);\n}\n\nhelpIconNode.addEventListener('animationend', function (event) {\n\tif (event.target.classList.contains('fadeout')) {\n\t\tevent.target.classList.remove('fadeout');\n\t\tevent.target.hidden = true;\n\t}\n\telse {\n\t\tevent.target.classList.remove('fadein');\n\t}\n});\n\nlet helpFadeHandle = 0;\nfunction fadeoutHelp () {\n\thelpIconNode.classList.add('fadeout');\n}\n\nfunction showHelpIcon () {\n\tclearTimeout(helpFadeHandle);\n\n\thelpIconNode.classList.remove('fadeout');\n\n\tif (helpIconNode.hidden) {\n\t\thelpIconNode.classList.add('fadein');\n\t\thelpIconNode.hidden = false;\n\t}\n\n\thelpFadeHandle = setTimeout(fadeoutHelp, HELP_FADE_DELAY);\n}\n\nfunction hideWelcome () {\n\twelcomeNode.hidden = true;\n}\n\nfunction onKeydown (event) {\n\tif (event.key === 'Escape') {\n\t\thideWelcome();\n\t}\n}\n\ndocument.addEventListener('keydown', onKeydown);\ndocument.body.addEventListener('pointermove', throttle(showHelpIcon), 500);\n\ncloseIcon.addEventListener('click', hideWelcome);\n\nfunction initClock (latitude, longitude) {\n\tconfig.geolocation = { latitude, longitude };\n\n\tconst now = new Date();\n\tconst timezoneOffset = -(now.getTimezoneOffset() / 60);\n\tconst jday = getJD(now.getFullYear(), now.getMonth() + 1, now.getDate());\n\tsunrise = calcSunriseSet(1, jday, latitude, longitude, timezoneOffset);\n\tsunset = calcSunriseSet(0, jday, latitude, longitude, timezoneOffset);\n\tconst timeInMinutes = (now.getHours() * 60) + now.getMinutes();\n\n\t// early morning of previous night\n\tif (timeInMinutes < sunrise.timelocal) {\n\t\tisNight = true;\n\t\tconst previousDay = new Date(now.getTime() - TWELVE_HOURS_IN_MS);\n\t\tconst previousJday = getJD(previousDay.getFullYear(), previousDay.getMonth() + 1, previousDay.getDate());\n\t\tconst previousSunset = calcSunriseSet(0, previousJday, latitude, longitude, timezoneOffset);\n\t\ttimePeriodBegin = previousSunset.timelocal;\n\t\ttimePeriodDuration = sunrise.timelocal + MINUTES_PER_DAY - timePeriodBegin;\n\t}\n\t// current day\n\telse if (timeInMinutes < sunset.timelocal) {\n\t\tisNight = false;\n\t\ttimePeriodBegin = sunrise.timelocal;\n\t\ttimePeriodDuration = sunset.timelocal - sunrise.timelocal;\n\t}\n\t// night time\n\telse {\n\t\tisNight = true;\n\t\ttimePeriodBegin = sunset.timelocal;\n\t\tconst nextDay = new Date(now.getTime() + TWELVE_HOURS_IN_MS);\n\t\tconst nextJday = getJD(nextDay.getFullYear(), nextDay.getMonth() + 1, nextDay.getDate());\n\t\tsunrise = calcSunriseSet(1, nextJday, latitude, longitude, timezoneOffset);\n\t\ttimePeriodDuration = sunrise.timelocal + MINUTES_PER_DAY - timePeriodBegin;\n\t}\n\n\tif (isNight) {\n\t\tdocument.body.classList.add('night');\n\t}\n\telse {\n\t\tdocument.body.classList.remove('night');\n\t}\n\n\thideWelcome();\n\thelpFadeHandle = setTimeout(fadeoutHelp, HELP_FADE_DELAY);\n\tupdate();\n}\n\nconst hasGeolocation = 'geolocation' in navigator;\n\nfunction showLocationForm () {\n\tconst wikiButton = document.getElementById('wikiButton');\n\twikiButton.addEventListener('click', function () {\n\t\tconst cityInput = document.getElementById('city');\n\t\tif (cityInput.value) {\n\t\t\twindow.open(`https://en.wikipedia.org/w/index.php?title=Special%3ASearch&search=${cityInput.value}`, '_blank');\n\t\t}\n\t});\n\n\tconst coordinatesForm = document.getElementById('coordinatesForm');\n\tcoordinatesForm.addEventListener('submit', function (event) {\n\t\tevent.preventDefault();\n\t\tconst { latitude, longitude } = coordinatesForm.elements;\n\t\tinitClock(Number(latitude.value), Number(longitude.value));\n\t});\n\n\tconst locationForm = document.getElementById('locationForm');\n\tlocationForm.hidden = false;\n}\n\nfunction showWelcomeDialog () {\n\tconst locationButton = document.getElementById('locationButton');\n\tif (hasGeolocation) {\n\t\tlocationButton.addEventListener('click', function () {\n\t\t\tnavigator.geolocation.getCurrentPosition(function (position) {\n\t\t\t\tinitClock(position.coords.latitude, position.coords.longitude);\n\t\t\t}, showLocationForm);\n\t\t});\n\t}\n\telse {\n\t\tlocationButton.hidden = true;\n\t\tshowLocationForm();\n\t}\n\n\twelcomeNode.hidden = false;\n}\n\nlet { geolocation } = config;\nif (geolocation) {\n\tinitClock(geolocation.latitude, geolocation.longitude);\n}\nelse {\n\tshowWelcomeDialog();\n}\n\nhelpIconNode.addEventListener('click', showWelcomeDialog);\nfadeOverlayNode.addEventListener('animationend', function (event) {\n\tif (event.animationName === 'nightFade') {\n\t\tevent.target.classList.remove('nightFade');\n\t\tevent.target.classList.add('night');\n\t}\n\telse {\n\t\tevent.target.classList.remove('morningFade');\n\t\tevent.target.classList.remove('night');\n\t}\n});\n\ndocument.addEventListener('keydown', function (event) {\n\tlet baseSize = config.baseSize ||\n\t\tparseInt(getComputedStyle(clockNode).getPropertyValue('--base-size'), 10);\n\n\tif (event.key === '=' || event.key === '+') {\n\t\tbaseSize += 1;\n\t\tclockNode.style.setProperty('--base-size', `${baseSize}px`);\n\t\tconfig.baseSize = baseSize;\n\t}\n\telse if (event.key === '-') {\n\t\tbaseSize -= 1;\n\t\tclockNode.style.setProperty('--base-size', `${baseSize}px`);\n\t\tconfig.baseSize = baseSize;\n\t}\n});\n"]}